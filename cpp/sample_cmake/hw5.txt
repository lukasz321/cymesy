//HW5 by Lukasz Zagaja
//SU Net ID: lzagaja SUID: 246071378

//HW5.  Due: Wednesday (November 17) at 11:59pm

#include <iostream>
#include <map>
#include <list>
#include <vector>
#include <set>
#include <unordered_set>
#include <unordered_map>

using namespace std;

class myCompareClass {
	//For all comparions, compare the sums of all int objects in the structures.


public:

	bool operator()(int* p1, int* p2) const {
        return *p1 < *p2;
    }; //set<int *>
	
    bool operator() (list<set<int*, myCompareClass>*>* p1, list<set<int*, myCompareClass>*>* p2) const {
        int sum_p1 = 0;
        for (auto& i : *p1) {
            for (auto& j : *i) {
                sum_p1 += *j;
            }
        }
        
        int sum_p2 = 0;
        for (auto& i : *p2) {
            for (auto& j : *i) {
                sum_p2 += *j;
            }
        }
        return sum_p1 < sum_p2;
    };
	bool operator() (const map < list<set<int*, myCompareClass>*>*, vector<int*>*, myCompareClass >& M1,
		const map < list<set<int*, myCompareClass>*>*, vector<int*>*, myCompareClass >& M2)  const {
        
        int sum_m1 = 0;

        for (auto& m : M1) {
            auto l = m.first;
            for (auto& i : *l) {
                for (auto& j : *i) {
                    sum_m1 += *j;
                }
            }

            auto v = m.second;
            for (auto& i : *v) {
                sum_m1 += *i;
            }
        }
        
        int sum_m2 = 0;
        for (auto& m : M2) {
            auto l = m.first;
            for (auto& i : *l) {
                for (auto& j : *i) {
                    sum_m2 += *j;
                }
            }

            auto v = m.second;
            for (auto& i : *v) {
                sum_m2 += *i;
            }
        }
        return sum_m1 < sum_m2;
    };
};



class myHashEqualClass {
	//For Hashing function use h(sums int in the sturcture), where hash<int> h;
	//For Hasing, the sum = 2*odd numbers + even numbers
public:

	bool operator() (const map < list<set<int*, myCompareClass>*>*, vector<int*>*, myCompareClass >& M1,
		const map < list<set<int*, myCompareClass>*>*, vector<int*>*, myCompareClass >& M2)  const {
        
        int sum_m1 = 0;
        for (auto& m : M1) {
            auto l = m.first;
            for (auto& i : *l) {
                for (auto& j : *i) {
                    if (*j % 2 == 0) {
                        sum_m1 += *j;
                    }
                    else {
                        sum_m1 += 2 * (*j);
                    }
                }
            }

            auto v = m.second;
            for (auto& i : *v) {
                if (*i % 2 == 0) {
                    sum_m1 += *i;
                }
                else {
                    sum_m1 += 2 * (*i);
                }
            }
        }
        
        int sum_m2 = 0;
        for (auto& m : M2) {
            auto l = m.first;
            for (auto& i : *l) {
                for (auto& j : *i) {
                    if (*j % 2 == 0) {
                        sum_m2 += *j;
                    }
                    else {
                        sum_m2 += 2 * (*j);
                    }
                }
            }

            auto v = m.second;
            for (auto& i : *v) {
                if (*i % 2 == 0) {
                    sum_m2 += *i;
                }
                else {
                    sum_m2 += 2 * (*i);
                }
            }
        }

		return sum_m1 == sum_m2;
    };

	size_t operator()(const map < list<set<int*, myCompareClass>*>*, vector<int*>*, myCompareClass >& M) const {
        int sum = 0;

        for (auto& m : M) {
            auto l = m.first;
            for (auto& i : *l) {
                for (auto& j : *i) {
                    if (*j % 2 == 0) {
                        sum += *j;
                    }
                    else {
                        sum += 2 * (*j);
                    }
                }
            }

            auto v = m.second;
            for (auto& i : *v) {
                if (*i % 2 == 0) {
                    sum += *i;
                }
                else {
                    sum += 2 * (*i);
                }
            }
        }

        hash <int> h;
		return h(sum);
    };

};

//The following is a suggestion. You can implement the overloaded operator<< differently.
template <class T> ostream& operator<<(ostream& str, const list<T*>& L) {
    cout << "[ ";
    for (auto& i : L) {
        str << *i << " ";
    }
    str << "] ";
    return str;
};

template <class T> ostream& operator<<(ostream& str, const set<T*, myCompareClass>& S) {
    cout << "< ";
    for (auto& i : S) {
        str << *i << " ";
    }
    str << ">";
    return str;
};

template <class T> ostream& operator<<(ostream& str, const vector<T*>& V) {
    cout << "( ";
    for (auto& i : V) {
        str << *i << " ";
    }
    str << ") ";
    return str;
};

template <class T> ostream& operator<<(ostream& str, const vector<T>& V) {
    cout << "( ";
    for (auto& i : V) {
        str << i << " ";
    }
    str << ") ";
    return str;
};

template <class T1, class T2> ostream& operator<<(ostream& str, const map<T1*, T2*, myCompareClass>& M) {
    str << "{ ";
    for (auto& i : M) {
        str << *(i.first) << *(i.second);
    }
    str << "}";
    return str;
};

template <class T1, class T2> ostream& operator<<(ostream& str, const map<T1, T2, myCompareClass>& M) {
    for (auto& i : M) {
        str << i.first << i.second;
    }
    return str;
};

template <class T> ostream& operator<<(ostream& str, const set<T, myCompareClass>& S) {
    str << "<" << endl;
    for (auto& i : S) {
        str << i << endl;
    }
    str << ">";
    return str;
};

template <class T1, class T2> ostream& operator<<(ostream& str, const unordered_map<T1, T2, myHashEqualClass, myHashEqualClass>& M) {
    str << "{" << endl;
    for (auto& i : M) {
        str << i.first << " " << i.second << endl;
    }
    str << "}";
    return str;
};


int main() {
    set<map<list<set<int*, myCompareClass>*>*, vector<int*>*, myCompareClass>, myCompareClass> S1 {
        {
            {
                new list<set<int*, myCompareClass>*> { 
                    new set <int*, myCompareClass> { 
                        new int{3}, 
                        new int{5}, 
                        new int{7}
                    },
                    new set <int*, myCompareClass> { 
                        new int{3}, 
                        new int{6}, 
                        new int{11}
                    },
                    new set <int*, myCompareClass> { 
                        new int{2}, 
                        new int{5}, 
                        new int{8}
                    },
                },
                    new vector<int*> {
                        new int{7},
                        new int{11},
                        new int{3},
                    }
            },
            {
                new list<set<int*, myCompareClass>*> { 
                    new set <int*, myCompareClass> { 
                        new int{3}, 
                        new int{4}, 
                        new int{5}
                    },
                    new set <int*, myCompareClass> { 
                        new int{2}, 
                        new int{6}, 
                        new int{13}
                    },
                    new set <int*, myCompareClass> { 
                        new int{2}, 
                        new int{5}, 
                        new int{18}
                    },
                },
                    new vector<int*> {
                        new int{5},
                        new int{11},
                        new int{13},
                    }
            },
            {
                new list<set<int*, myCompareClass>*> { 
                    new set <int*, myCompareClass> { 
                        new int{1}, 
                        new int{3}, 
                        new int{6}
                    },
                    new set <int*, myCompareClass> { 
                        new int{3}, 
                        new int{5}, 
                        new int{17}
                    },
                    new set <int*, myCompareClass> { 
                        new int{3}, 
                        new int{5}, 
                        new int{8}
                    },
                },
                    new vector<int*> {
                        new int{4},
                        new int{14},
                        new int{3},
                    }
            },
        },
        {
            {
                new list<set<int*, myCompareClass>*> { 
                    new set <int*, myCompareClass> { 
                        new int{3}, 
                        new int{4}, 
                        new int{13}
                    },
                    new set <int*, myCompareClass> { 
                        new int{5}, 
                        new int{2}, 
                        new int{12}
                    },
                    new set <int*, myCompareClass> { 
                        new int{16}, 
                        new int{13}, 
                        new int{2}
                    },
                },
                    new vector<int*> {
                        new int{5},
                        new int{17},
                        new int{2},
                    }
            },
            {
                new list<set<int*, myCompareClass>*> { 
                    new set <int*, myCompareClass> { 
                        new int{8}, 
                        new int{6}, 
                        new int{3}
                    },
                    new set <int*, myCompareClass> { 
                        new int{15}, 
                        new int{11}, 
                        new int{1}
                    },
                    new set <int*, myCompareClass> { 
                        new int{13}, 
                        new int{7}, 
                        new int{5}
                    },
                },
                    new vector<int*> {
                        new int{5},
                        new int{12},
                        new int{3},
                    }
            },
            {
                new list<set<int*, myCompareClass>*> { 
                    new set <int*, myCompareClass> { 
                        new int{11}, 
                        new int{9}, 
                        new int{3}
                    },
                    new set <int*, myCompareClass> { 
                        new int{5}, 
                        new int{3}, 
                        new int{4}
                    },
                    new set <int*, myCompareClass> { 
                        new int{6}, 
                        new int{5}, 
                        new int{13}
                    },
                },
                    new vector<int*> {
                        new int{4},
                        new int{14},
                        new int{3},
                    }
            },
        },
        {
            {
                new list<set<int*, myCompareClass>*> { 
                    new set <int*, myCompareClass> { 
                        new int{11}, 
                        new int{6}, 
                        new int{3}
                    },
                    new set <int*, myCompareClass> { 
                        new int{5}, 
                        new int{2}, 
                        new int{8}
                    },
                    new set <int*, myCompareClass> { 
                        new int{7}, 
                        new int{5}, 
                        new int{3}
                    },
                },
                    new vector<int*> {
                        new int{7},
                        new int{19},
                        new int{13},
                    }
            },
            {
                new list<set<int*, myCompareClass>*> { 
                    new set <int*, myCompareClass> { 
                        new int{3}, 
                        new int{5}, 
                        new int{17}
                    },
                    new set <int*, myCompareClass> { 
                        new int{8}, 
                        new int{5}, 
                        new int{3}
                    },
                    new set <int*, myCompareClass> { 
                        new int{6}, 
                        new int{3}, 
                        new int{1}
                    },
                },
                    new vector<int*> {
                        new int{4},
                        new int{14},
                        new int{3},
                    }
            },
            {
                new list<set<int*, myCompareClass>*> { 
                    new set <int*, myCompareClass> { 
                        new int{1}, 
                        new int{7}, 
                        new int{13}
                    },
                    new set <int*, myCompareClass> { 
                        new int{2}, 
                        new int{1}, 
                        new int{15}
                    },
                    new set <int*, myCompareClass> { 
                        new int{6}, 
                        new int{20}, 
                        new int{16}
                    },
                },
                    new vector<int*> {
                        new int{5},
                        new int{19},
                        new int{4},
                    }
            },
        },
    };

	cout << S1 << endl;

    vector<int> v1 { 7, 8, 9 };
    vector<int> v2 { 1, 2, 3 };
    vector<int> v3 { 3, 5, 7 };

    unordered_map< map < list<set<int*, myCompareClass>*>*, vector<int*>*, myCompareClass >, vector<int>, myHashEqualClass, myHashEqualClass> H1 {
        {
            {
                {
                    new list<set<int*, myCompareClass>*> { 
                        new set <int*, myCompareClass> { 
                            new int{3}, 
                            new int{5}, 
                            new int{7}
                        },
                        new set <int*, myCompareClass> { 
                            new int{3}, 
                            new int{6}, 
                            new int{11}
                        },
                        new set <int*, myCompareClass> { 
                            new int{2}, 
                            new int{5}, 
                            new int{8}
                        },
                    },
                        new vector<int*> {
                            new int{7},
                            new int{19},
                            new int{13},
                        }
                },
                {
                    new list<set<int*, myCompareClass>*> { 
                        new set <int*, myCompareClass> { 
                            new int{3}, 
                            new int{5}, 
                            new int{17}
                        },
                        new set <int*, myCompareClass> { 
                            new int{1}, 
                            new int{3}, 
                            new int{6}
                        },
                        new set <int*, myCompareClass> { 
                            new int{3}, 
                            new int{5}, 
                            new int{8}
                        },
                    },
                        new vector<int*> {
                            new int{4},
                            new int{14},
                            new int{3},
                        }
                },
                {
                    new list<set<int*, myCompareClass>*> { 
                        new set <int*, myCompareClass> { 
                            new int{7}, 
                            new int{1}, 
                            new int{13}
                        },
                        new set <int*, myCompareClass> { 
                            new int{15}, 
                            new int{2}, 
                            new int{1}
                        },
                        new set <int*, myCompareClass> { 
                            new int{20}, 
                            new int{16}, 
                            new int{6}
                        },
                    },
                        new vector<int*> {
                            new int{5},
                            new int{19},
                            new int{4},
                        }
                },
            },
            v1
        },
        {
            {
                {
                    new list<set<int*, myCompareClass>*> { 
                        new set <int*, myCompareClass> { 
                            new int{3}, 
                            new int{5}, 
                            new int{7}
                        },
                        new set <int*, myCompareClass> { 
                            new int{3}, 
                            new int{6}, 
                            new int{11}
                        },
                        new set <int*, myCompareClass> { 
                            new int{2}, 
                            new int{5}, 
                            new int{8}
                        },
                    },
                        new vector<int*> {
                            new int{7},
                            new int{11},
                            new int{3},
                        }
                },
                {
                    new list<set<int*, myCompareClass>*> { 
                        new set <int*, myCompareClass> { 
                            new int{3}, 
                            new int{5}, 
                            new int{17}
                        },
                        new set <int*, myCompareClass> { 
                            new int{1}, 
                            new int{3}, 
                            new int{6}
                        },
                        new set <int*, myCompareClass> { 
                            new int{3}, 
                            new int{5}, 
                            new int{8}
                        },
                    },
                        new vector<int*> {
                            new int{4},
                            new int{14},
                            new int{3},
                        }
                },
                {
                    new list<set<int*, myCompareClass>*> { 
                        new set <int*, myCompareClass> { 
                            new int{3}, 
                            new int{4}, 
                            new int{5}
                        },
                        new set <int*, myCompareClass> { 
                            new int{18}, 
                            new int{5}, 
                            new int{2}
                        },
                        new set <int*, myCompareClass> { 
                            new int{13}, 
                            new int{6}, 
                            new int{2}
                        },
                    },
                        new vector<int*> {
                            new int{5},
                            new int{11},
                            new int{13},
                        }
                },
            },
            v2
        },
        {
            {
                {
                    new list<set<int*, myCompareClass>*> { 
                        new set <int*, myCompareClass> { 
                            new int{5}, 
                            new int{6}, 
                            new int{13}
                        },
                        new set <int*, myCompareClass> { 
                            new int{5}, 
                            new int{4}, 
                            new int{3}
                        },
                        new set <int*, myCompareClass> { 
                            new int{11}, 
                            new int{9}, 
                            new int{3}
                        },
                    },
                        new vector<int*> {
                            new int{4},
                            new int{14},
                            new int{3},
                        }
                },
                {
                    new list<set<int*, myCompareClass>*> { 
                        new set <int*, myCompareClass> { 
                            new int{5}, 
                            new int{7}, 
                            new int{13}
                        },
                        new set <int*, myCompareClass> { 
                            new int{1}, 
                            new int{11}, 
                            new int{15}
                        },
                        new set <int*, myCompareClass> { 
                            new int{8}, 
                            new int{6}, 
                            new int{3}
                        },
                    },
                        new vector<int*> {
                            new int{5},
                            new int{12},
                            new int{3},
                        }
                },
                {
                    new list<set<int*, myCompareClass>*> { 
                        new set <int*, myCompareClass> { 
                            new int{2}, 
                            new int{12}, 
                            new int{5}
                        },
                        new set <int*, myCompareClass> { 
                            new int{3}, 
                            new int{4}, 
                            new int{13}
                        },
                        new set <int*, myCompareClass> { 
                            new int{2}, 
                            new int{16}, 
                            new int{13}
                        },
                    },
                        new vector<int*> {
                            new int{5},
                            new int{17},
                            new int{2},
                        }
                },
            },
            v3
        },
    };

	cout << H1 << endl;
	return 0;
}
